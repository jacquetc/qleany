// Generated by Qleany. Edit at your own risk! Be careful when regenerating this file
// as changes will be lost.

use super::units_of_work::RootUnitOfWorkFactory;
use super::{
    dtos::{CreateRootDto, RootDto},
    units_of_work::RootUnitOfWorkROFactory,
    use_cases::{
        create_root_multi_uc::CreateRootMultiUseCase, create_root_uc::CreateRootUseCase,
        get_root_multi_uc::GetRootMultiUseCase, get_root_uc::GetRootUseCase,
        remove_root_multi_uc::RemoveRootMultiUseCase, remove_root_uc::RemoveRootUseCase,
        update_root_multi_uc::UpdateRootMultiUseCase, update_root_uc::UpdateRootUseCase,
    },
};
use anyhow::{Ok, Result};

use crate::root::use_cases::get_root_relationship_uc::GetRootRelationshipUseCase;
use crate::root::use_cases::set_root_relationship_uc::SetRootRelationshipUseCase;
use crate::RootRelationshipDto;
use common::direct_access::root::RootRelationshipField;

use common::{database::db_context::DbContext, event::EventHub, types::EntityId};
use std::sync::Arc;

pub fn create(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    entity: &CreateRootDto,
) -> Result<RootDto> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = CreateRootUseCase::new(Box::new(uow_factory));
    let result = uc.execute(entity.clone())?;
    Ok(result)
}

pub fn get(db_context: &DbContext, id: &EntityId) -> Result<Option<RootDto>> {
    let uow_factory = RootUnitOfWorkROFactory::new(&db_context);
    let uc = GetRootUseCase::new(Box::new(uow_factory));
    uc.execute(id)
}

pub fn update(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    entity: &RootDto,
) -> Result<RootDto> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = UpdateRootUseCase::new(Box::new(uow_factory));
    let result = uc.execute(entity)?;
    Ok(result)
}

pub fn remove(db_context: &DbContext, event_hub: &Arc<EventHub>, id: &EntityId) -> Result<()> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = RemoveRootUseCase::new(Box::new(uow_factory));
    uc.execute(id)?;
    Ok(())
}

pub fn create_multi(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    entities: &[CreateRootDto],
) -> Result<Vec<RootDto>> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = CreateRootMultiUseCase::new(Box::new(uow_factory));
    let result = uc.execute(entities)?;
    Ok(result)
}

pub fn get_multi(db_context: &DbContext, ids: &[EntityId]) -> Result<Vec<Option<RootDto>>> {
    let uow_factory = RootUnitOfWorkROFactory::new(&db_context);
    let uc = GetRootMultiUseCase::new(Box::new(uow_factory));
    uc.execute(ids)
}

pub fn update_multi(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    entities: &[RootDto],
) -> Result<Vec<RootDto>> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = UpdateRootMultiUseCase::new(Box::new(uow_factory));
    let result = uc.execute(entities)?;
    Ok(result)
}

pub fn remove_multi(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    ids: &[EntityId],
) -> Result<()> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = RemoveRootMultiUseCase::new(Box::new(uow_factory));
    uc.execute(ids)?;
    Ok(())
}

pub fn get_relationship(
    db_context: &DbContext,
    id: &EntityId,
    field: &RootRelationshipField,
) -> Result<Vec<EntityId>> {
    let uow_factory = RootUnitOfWorkROFactory::new(&db_context);
    let uc = GetRootRelationshipUseCase::new(Box::new(uow_factory));
    uc.execute(id, field)
}

pub fn set_relationship(
    db_context: &DbContext,
    event_hub: &Arc<EventHub>,
    dto: &RootRelationshipDto,
) -> Result<()> {
    let uow_factory = RootUnitOfWorkFactory::new(&db_context, &event_hub);
    let mut uc = SetRootRelationshipUseCase::new(Box::new(uow_factory));
    uc.execute(dto)?;
    Ok(())
}
