import { LineEdit, ComboBox, ProgressIndicator } from "std-widgets.slint";
import { ProjectTabState } from "../globals.slint";
import { Paper, FormField, StyledLineEdit, Alert } from "../components/misc.slint";

// Styled select/combo box
component StyledComboBox inherits Rectangle {
    in-out property <string> current-value;
    in property <[string]> model;
    in property <bool> enabled: true;
    callback selected(string);
    
    height: 36px;
    background: enabled ? #ffffff : #f8f9fa;
    border-width: 1px;
    border-color: #ced4da;
    border-radius: 4px;
    
    combo := ComboBox {
        current-value <=> root.current-value;
        model: root.model;
        enabled: root.enabled;
        selected(val) => { root.selected(val); }
    }
}

export component ProjectTab inherits Rectangle {
    background: #ffffff;

    VerticalLayout {
        padding: 40px;
        spacing: 24px;

        // Title
        Text {
            text: "Project Settings";
            font-size: 32px;
            font-weight: 700;
            color: #212529;
        }

        // Form in Paper
        Paper {
            with-border: true;
            
            VerticalLayout {
                padding: 16px;
                spacing: 16px;

                FormField {
                    label: "Language";
                    required: true;
                    
                    language-combo := StyledComboBox {
                        current-value <=> ProjectTabState.language;
                        model: ["Rust", "C++ / Qt"];
                        selected(val) => {
                            ProjectTabState.language_changed(val);
                        }
                    }
                }

                FormField {
                    label: "Application Name";
                    required: true;
                    error-message: ProjectTabState.application_name == "" ? "Application name is required" : "";
                    
                    StyledLineEdit {
                        text <=> ProjectTabState.application_name;
                        placeholder: "Enter application name";
                        has-error: ProjectTabState.application_name == "";
                        edited(text) => {
                            ProjectTabState.application_name_changed(text);
                        }
                    }
                }

                FormField {
                    label: "Organisation Name";
                    required: true;
                    error-message: ProjectTabState.organisation_name == "" ? "Organisation name is required" : "";
                    
                    StyledLineEdit {
                        text <=> ProjectTabState.organisation_name;
                        placeholder: "Enter organisation name";
                        has-error: ProjectTabState.organisation_name == "";
                        edited(text) => {
                            ProjectTabState.organisation_name_changed(text);
                        }
                    }
                }

                FormField {
                    label: "Organisation Domain";
                    required: true;
                    error-message: ProjectTabState.organisation_domain == "" ? "Organisation domain is required" : "";
                    
                    StyledLineEdit {
                        text <=> ProjectTabState.organisation_domain;
                        placeholder: "Enter organisation domain (e.g., com.example)";
                        has-error: ProjectTabState.organisation_domain == "";
                        edited(text) => {
                            ProjectTabState.organisation_domain_changed(text);
                        }
                    }
                }

                FormField {
                    label: "Prefix Path";
                    
                    StyledLineEdit {
                        text <=> ProjectTabState.prefix_path;
                        placeholder: "Enter prefix path";
                        edited(text) => {
                            ProjectTabState.prefix_path_changed(text);
                        }
                    }
                }
            }
        }

        // Spacer
        Rectangle { vertical-stretch: 1; }
    }
}
