// Generated by Qleany. Edit at your own risk! Be careful when regenerating this file
// as changes will be lost.

use crate::types::EntityId;
use serde::{Deserialize, Serialize};

/// Snapshot of rows from a single entity table, stored as bincode-serialized bytes.
#[derive(Debug, Clone, Default, Serialize, Deserialize)]
pub struct TableSnapshot {
    pub table_name: String,
    pub rows: Vec<(EntityId, Vec<u8>)>,
}

/// Snapshot of entries from a single junction table.
#[derive(Debug, Clone, Default, Serialize, Deserialize)]
pub struct JunctionSnapshot {
    pub table_name: String,
    pub entries: Vec<(EntityId, Vec<EntityId>)>,
}

/// Complete snapshot of a single entity table level: the entity rows plus all
/// forward and backward junction tables that reference them.
#[derive(Debug, Clone, Default, Serialize, Deserialize)]
pub struct TableLevelSnapshot {
    pub entity_rows: TableSnapshot,
    pub forward_junctions: Vec<JunctionSnapshot>,
    pub backward_junctions: Vec<JunctionSnapshot>,
}

/// Recursive snapshot of an entity and all its strong-relationship children.
/// Used for delete undo/redo: snapshot before delete, restore on undo.
#[derive(Debug, Clone, Default, Serialize, Deserialize)]
pub struct EntityTreeSnapshot {
    pub table_data: TableLevelSnapshot,
    pub children: Vec<EntityTreeSnapshot>,
}
